{"mappings":"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","sources":["src/js/controller.js"],"sourcesContent":["(async () => {\n  let baseUrlGTilebit = 'https://xju6-kpzy-l8vj.n7.xano.io/api:4lTavcfO';\n  let baseUrlGOutseta = 'https://xju6-kpzy-l8vj.n7.xano.io/api:8p4wLdYy';\n  let platformData = '';\n  let contentType = '';\n  let targetButton = '[bmg-arco-button]';\n  let isSnippetCopy = false;\n  let xtoken = null;\n  let memberData = null;\n\n  const ostoken = Outseta.getAccessToken();\n  if (ostoken) {\n    memberData = await Outseta.getUser();\n  }\n\n  const member = memberData;\n  let memberJson = {};\n\n  if (member) {\n    const memberJsonData = {};\n    memberJsonData.savedComp = JSON.parse(member.SavedComponents || '[]');\n    memberJsonData.savedInspo = JSON.parse(member.SavedInspirations || '[]');\n    memberJson = memberJsonData;\n  }\n\n  const urlParams = new URLSearchParams(window.location.search);\n  let accessToken = urlParams.get('access_token')\n    ? urlParams.get('access_token')\n    : localStorage.getItem('Outseta.nocode.accessToken');\n  if (accessToken) {\n    // Generate xtoken if accessToken is present\n    try {\n      const res = await callXApi(baseUrlGOutseta, 'outseta/auth', 'POST', {token:accessToken});\n      if (res?.authToken) {\n        xtoken = res.authToken;\n      }\n    } catch (error) {\n      console.error('erore nel recupero xano token');\n    }\n  }\n\n  window.fsAttributes = window.fsAttributes || [];\n  window.fsAttributes.push([\n    'cmsload',\n    listInstances => {\n      console.log('cmsload Successfully loaded!');\n\n      const [listInstance] = listInstances;\n\n      listInstance.on('renderitems', renderedItems => {\n        console.log('page changed');\n        setListener();\n      });\n\n      const pageName = location.href.split('/').slice(-1)[0];\n      if (memberJson.savedComp && pageName === 'saved') {\n        $('[comp-card]').each((i, item) => {\n          const itemId = $(item).closest('[tb-item-id]').attr('tb-item-id');\n          if (\n            memberJson.savedComp.indexOf(itemId) !== -1 ||\n            memberJson.savedInspo.indexOf(itemId) !== -1\n          ) {\n            $(item).closest('[comp-item]').removeClass('hide');\n          }\n        });\n      }\n    },\n  ]);\n\n  function copyComponent(element, platform, componentId) {\n    const endpoint = `components/${componentId}/platform/${platform}`;\n    let platformwrapper = element.find('[tb-pl-butt-wrapper]').clone();\n\n    async function displayMessage(message) {\n      setTimeout(function () {\n        element.text(message);\n        setTimeout(function () {\n          element.empty();\n          element.append(platformwrapper);\n          element.css({ 'pointer-events': 'auto' });\n        }, 1500);\n      }, 1500);\n    }\n\n    element.css({ 'pointer-events': 'none' });\n    element.empty();\n    element.text('Copying...');\n\n    callXApi(baseUrlGTilebit, endpoint, 'GET')\n      .then(responseData => {\n        platformData = responseData[platform];\n        contentType =\n          platformData.charAt(0) === '{' ? 'application/json' : 'text/html';\n        isSnippetCopy = true;\n        document.execCommand('copy');\n        displayMessage('Copied!');\n      })\n      .catch(error => {\n        debugger\n        displayMessage(`Error: ${error.message}`);\n      });\n  }\n\n  document.addEventListener('copy', event => {\n    if (isSnippetCopy) {\n      event.clipboardData.setData(contentType, platformData);\n      event.preventDefault();\n      isSnippetCopy = false;\n    }\n  });\n\n  const setListener = () => {\n    $('.actions-button-wrapper, [action-button]').click(function (event) {\n      event.stopPropagation();\n      return true;\n    });\n\n    $(targetButton).click(function (event) {\n      if (!member) {\n        $('[lock-modal-button]')[0].click();\n        return;\n      }\n\n      const platform = $(this).attr('bmg-arco-button');\n      const id = $(this).closest('[tb-item-id]').attr('tb-item-id');\n      copyComponent($(this), platform, id);\n    });\n\n    new ClipboardJS('[data-clipboard-text]').on('success', function (el) {\n      const tippyInstance = el.trigger._tippy;\n      tippyInstance.setContent('Copied');\n      tippyInstance.show();\n    });\n\n    tippy('[data-tippy-content]', {\n      trigger: 'manual',\n      duration: 100,\n      onShow(instance) {\n        setTimeout(() => {\n          instance.hide();\n        }, 1000);\n      },\n    });\n\n    $('[comp-card-save-btn]').click(async function (event) {\n      if (!member) {\n        $('[lock-modal-button]')[0].click();\n        return;\n      }\n\n      const tippyInstance = this._tippy;\n      const itemId = $(this).closest('[tb-item-id]').attr('tb-item-id');\n      const isInspo =\n        $(this).closest('[comp-card]').attr('comp-card') === 'inspiration';\n\n      if (isInspo) {\n        memberJson.savedInspo = memberJson.savedInspo || [];\n        if (memberJson.savedInspo.indexOf(itemId) === -1) {\n          memberJson.savedInspo.push(itemId);\n          const num = memberJson.savedInspo.length || 0;\n          memberJson.savedInspoNum = num;\n          await member.update({\n            SavedInspirations: JSON.stringify(memberJson.savedInspo),\n          });\n\n          tippyInstance.setContent('Saved');\n          tippyInstance.show();\n          return;\n        }\n      } else {\n        memberJson.savedComp = memberJson.savedComp || [];\n        if (memberJson.savedComp.indexOf(itemId) === -1) {\n          memberJson.savedComp.push(itemId);\n          const num = memberJson.savedComp.length || 0;\n          memberJson.savedCompNum = num;\n          await member.update({\n            SavedComponents: JSON.stringify(memberJson.savedComp),\n          });\n\n          tippyInstance.setContent('Saved');\n          tippyInstance.show();\n          return;\n        }\n      }\n\n      tippyInstance.setContent('Already saved');\n      tippyInstance.show();\n    });\n\n    // todo da cambiare\n    $(document).on('click', '.hack32-like-item .del', function () {\n      const name = $.trim(\n        $(this).closest('.hack32-like-item').find('.hack32-title').text()\n      );\n      if (metadata.fileNames.indexOf(name) !== -1) {\n        metadata.fileNames.splice(metadata.fileNames.indexOf(name), 1);\n        metadata.itemsNum = metadata.fileNames.length;\n        $('.hack32-like-count').text(metadata.itemsNum);\n        member.updateMetaData(metadata);\n      }\n\n      $(this).closest('.hack32-like-item').remove();\n    });\n  };\n\n  // Funzione per effettuare la chiamata all'API\n  async function callXApi(baseUrlGroup, endpoint, method, data) {\n    const url = `${baseUrlGroup}/${endpoint}`;\n\n    // Imposta l'intestazione Authorization con il token di autenticazione\n    const headers = {\n      Authorization: `Bearer ${xtoken}`,\n      'Content-Type': 'application/json',\n    };\n\n    // Configurazione della richiesta\n    const options = {\n      method,\n      headers,\n      body: JSON.stringify(data),\n    };\n\n    try {\n      // Effettua la chiamata all'API utilizzando fetch() e attendi la risposta\n      const response = await fetch(url, options);\n      const result = await response.json();\n\n      return result;\n      // Gestisci la risposta dell'API\n    } catch (error) {\n      // Gestisci gli errori\n      throw new Error(`Error: ${error}`);\n    }\n  }\n\n  setListener();\n})().catch(err => {\n  console.error(err);\n});\n"],"names":["baseUrlGTilebit","platformData","contentType","isSnippetCopy","xtoken","memberData","Outseta","getAccessToken","getUser","member","memberJson","memberJsonData","savedComp","JSON","parse","SavedComponents","savedInspo","SavedInspirations","urlParams","URLSearchParams","window","location","search","accessToken","get","localStorage","getItem","res","callXApi","token","authToken","error","console","fsAttributes","push","listInstances","log","listInstance","on","renderedItems","setListener","pageName","href","split","slice","$","each","i","item","itemId","closest","attr","indexOf","removeClass","document","addEventListener","event","clipboardData","setData","preventDefault","click","stopPropagation","platform","this","id","element","componentId","endpoint","platformwrapper","find","clone","async","displayMessage","message","setTimeout","text","empty","append","css","then","responseData","charAt","execCommand","catch","copyComponent","ClipboardJS","el","tippyInstance","trigger","_tippy","setContent","show","tippy","duration","onShow","instance","hide","num","length","savedInspoNum","update","stringify","savedCompNum","name","trim","metadata","fileNames","splice","itemsNum","updateMetaData","remove","baseUrlGroup","method","data","url","options","Authorization","body","response","fetch","json","Error","err"],"version":3,"file":"index.70d84e35.js.map"}