{"mappings":"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","sources":["src/js/controller.js"],"sourcesContent":["(async () => {\n  /**\n   * --------------------------------------------------------------------------------------\n   * VARIABLES\n   *\n   */\n\n  window.fsAttributes = window.fsAttributes || [];\n  const urlParams = new URLSearchParams(window.location.search);\n  let baseUrlGTilebit = 'https://xju6-kpzy-l8vj.n7.xano.io/api:4lTavcfO';\n  let baseUrlGOutseta = 'https://xju6-kpzy-l8vj.n7.xano.io/api:8p4wLdYy';\n  let baseUrlGPaddle = 'https://xju6-kpzy-l8vj.n7.xano.io/api:9U9Y_l4P';\n  let platformData = '';\n  let contentType = '';\n  let platformSnippetAttribute = '[bmg-arco-button]';\n  let isSnippetCopy = false;\n  let xtoken = null;\n  let xUserId = null;\n  let member = null;\n  let memberJson = {};\n  let paddleSubscription = null;\n  const paddleFreelanceMonthlyId = 52522;\n  const paddleFreelanceYearlyId = 52668;\n  let accessToken = urlParams.get('access_token')\n    ? urlParams.get('access_token')\n    : localStorage.getItem('Outseta.nocode.accessToken');\n\n  /**\n   * --------------------------------------------------------------------------------------\n   * END VARIABLES\n   *\n   */\n\n  /**\n   * --------------------------------------------------------------------------------------\n   * MODELS\n   *\n   */\n\n  function scrollToTop() {\n    // Smooth scroll animation\n    const div = document.getElementById('filters-section');\n  \n  // Scroll smoothly to the top position of the div\n  div.scrollIntoView({\n    behavior: 'smooth',\n    block: 'start'\n  });\n  }\n\n  function copyComponent(element, platform, componentId) {\n    const endpoint = `components/${componentId}/platform/${platform}`;\n    let platformwrapper = element.find('[tb-pl-butt-wrapper]').clone();\n\n    async function displayMessage(message) {\n      setTimeout(function () {\n        element.text(message);\n        setTimeout(function () {\n          element.empty();\n          element.append(platformwrapper);\n          element.css({ 'pointer-events': 'auto' });\n        }, 1500);\n      }, 1500);\n    }\n\n    element.css({ 'pointer-events': 'none' });\n    element.empty();\n    element.text('Copying...');\n\n    callXApi(baseUrlGTilebit, endpoint, 'GET')\n      .then(responseData => {\n        platformData = responseData[platform];\n        contentType =\n          platformData.charAt(0) === '{' ? 'application/json' : 'text/html';\n        isSnippetCopy = true;\n        document.execCommand('copy');\n        displayMessage('Copied!');\n      })\n      .catch(error => {\n        debugger;\n        displayMessage(`Error: ${error.message}`);\n      });\n  }\n\n  const setListener = () => {\n    setTippyHover();\n\n    // showLockPaidElm()\n\n    $('.actions-button-wrapper, [action-button]').click(function (event) {\n      event.stopPropagation();\n      return true;\n    });\n\n    $(platformSnippetAttribute).click(function (event) {\n      //not logged in show modal\n      if (!member) {\n        $('[lock-modal-button]')[0].click();\n        return;\n      }\n      //not paid member redirect to pricing\n      if (!isPaidSubscritionActive()) {\n        window.location.href = '/pricing';\n        return;\n      }\n\n      const platform = $(this).attr('bmg-arco-button');\n      const id = $(this).closest('[tb-item-id]').attr('tb-item-id');\n      copyComponent($(this), platform, id);\n    });\n\n    new ClipboardJS('[data-clipboard-text]').on('success', function (el) {\n      const tippyInstance = el.trigger._tippy;\n      tippyInstance.setContent('Copied');\n      tippyInstance.show();\n    });\n\n    tippy('[data-tippy-content]', {\n      trigger: 'manual',\n      duration: 100,\n      onShow(instance) {\n        setTimeout(() => {\n          instance.hide();\n        }, 1000);\n      },\n    });\n\n    $('[comp-card-save-btn]').click(async function (event) {\n      if (!member) {\n        $('[lock-modal-button]')[0].click();\n        return;\n      }\n\n      const tippyInstance = this._tippy;\n      const itemId = $(this).closest('[tb-item-id]').attr('tb-item-id');\n      const isInspo =\n        $(this).closest('[comp-card]').attr('comp-card') === 'inspiration';\n\n      if (isInspo) {\n        memberJson.savedInspo = memberJson.savedInspo || [];\n        if (memberJson.savedInspo.indexOf(itemId) === -1) {\n          memberJson.savedInspo.push(itemId);\n          const num = memberJson.savedInspo.length || 0;\n          memberJson.savedInspoNum = num;\n          await member.update({\n            SavedInspirations: JSON.stringify(memberJson.savedInspo),\n          });\n\n          tippyInstance.setContent('Saved');\n          tippyInstance.show();\n          return;\n        }\n      } else {\n        memberJson.savedComp = memberJson.savedComp || [];\n        if (memberJson.savedComp.indexOf(itemId) === -1) {\n          memberJson.savedComp.push(itemId);\n          const num = memberJson.savedComp.length || 0;\n          memberJson.savedCompNum = num;\n          await member.update({\n            SavedComponents: JSON.stringify(memberJson.savedComp),\n          });\n\n          tippyInstance.setContent('Saved');\n          tippyInstance.show();\n          return;\n        }\n      }\n\n      tippyInstance.setContent('Already saved');\n      tippyInstance.show();\n    });\n\n    // todo da cambiare\n    $(document).on('click', '.hack32-like-item .del', function () {\n      const name = $.trim(\n        $(this).closest('.hack32-like-item').find('.hack32-title').text()\n      );\n      if (metadata.fileNames.indexOf(name) !== -1) {\n        metadata.fileNames.splice(metadata.fileNames.indexOf(name), 1);\n        metadata.itemsNum = metadata.fileNames.length;\n        $('.hack32-like-count').text(metadata.itemsNum);\n        member.updateMetaData(metadata);\n      }\n\n      $(this).closest('.hack32-like-item').remove();\n    });\n  };\n\n  // Funzione per effettuare la chiamata all'API\n  async function callXApi(baseUrlGroup, endpoint, method, data) {\n    const url = `${baseUrlGroup}/${endpoint}`;\n\n    // Imposta l'intestazione Authorization con il token di autenticazione\n    const headers = {\n      Authorization: `Bearer ${xtoken}`,\n      'Content-Type': 'application/json',\n    };\n\n    // Configurazione della richiesta\n    const options = {\n      method,\n      headers,\n      body: JSON.stringify(data),\n    };\n\n    try {\n      // Effettua la chiamata all'API utilizzando fetch() e attendi la risposta\n      const response = await fetch(url, options);\n      const result = await response.json();\n\n      return result;\n      // Gestisci la risposta dell'API\n    } catch (error) {\n      // Gestisci gli errori\n      throw new Error(`Error: ${error}`);\n    }\n  }\n\n  function isPaidSubscritionActive() {\n    if (!paddleSubscription) {\n      return false;\n    }\n\n    if (\n      paddleSubscription.state == 'active' ||\n      paddleSubscription.state == 'trialing'||\n      paddleSubscription.state == 'past_due' \n\n    ) {\n      return true;\n    }\n    if (\n      paddleSubscription.state == 'paused' ||\n      paddleSubscription.state == 'deleted'\n    ) {\n      return false;\n    }\n  }\n\n  function openFreelanceMonthlyCheckout() {\n    debugger;\n    Paddle.Checkout.open({\n      product: paddleFreelanceMonthlyId,\n      email: member.Email,\n      passthrough: `{\"x_user_id\": \"${xUserId}\"}`,\n    });\n  }\n  function openFreelanceYearlyCheckout() {\n    debugger;\n    Paddle.Checkout.open({\n      product: paddleFreelanceYearlyId,\n      email: member.Email,\n      passthrough: `{\"x_user_id\": \"${xUserId}\"}`,\n    });\n  }\n\n  function openUpdatePaddle() {\n    debugger;\n    Paddle.Checkout.open({\n      override: paddleSubscription.update_url,\n      passthrough: `{\"x_user_id\": \"${xUserId}\"}`,\n    });\n  }\n\n  function openCancelPaddle() {\n    debugger;\n    Paddle.Checkout.open({\n      override: paddleSubscription.cancel_url,\n      passthrough: `{\"x_user_id\": \"${xUserId}\"}`,\n    });\n  }\n\n  function showLockPaidElm() {\n    $('.lock').css({ display: 'block', opacity: '0' });\n  }\n\n  /**\n   * --------------------------------------------------------------------------------------\n   * END MODELS\n   *\n   */\n\n  /**\n   * --------------------------------------------------------------------------------------\n   * CONTROLLERS\n   *\n   */\n\n  //if accesstoken is preset the user is loggedin\n  if (accessToken) {\n    //fire only if user is loggedin\n    Outseta.getUser()\n      .then(user => {\n        member = user;\n        amplitude.setUserId(member.Uid);\n\n        const memberJsonData = {};\n        memberJsonData.savedComp = JSON.parse(member.SavedComponents || '[]');\n        memberJsonData.savedInspo = JSON.parse(\n          member.SavedInspirations || '[]'\n        );\n        memberJson = memberJsonData;\n      })\n      .catch(err => {\n        debugger;\n      });\n\n    // Generate xtoken if accessToken is present\n    try {\n      const res = await callXApi(baseUrlGOutseta, 'outseta/auth', 'POST', {\n        token: accessToken,\n      });\n      if (res?.authToken) {\n        xtoken = res.authToken;\n        xUserId = res.user_id;\n      }\n    } catch (error) {\n      console.error('erore nel recupero xano token');\n    }\n\n    try {\n      //fetch user paddle sub\n      const paddleRes = await callXApi(\n        baseUrlGPaddle,\n        'user/subscription',\n        'GET'\n      );\n      paddleSubscription = paddleRes;\n      //debugger;\n\n      // if (!isPaidSubscritionActive()) {\n      //   //show lock\n      //   showLockPaidElm()\n      // }\n    } catch (error) {\n      console.error('erore nel recupero subscription');\n    }\n  }\n\n  window.fsAttributes.push([\n    'cmsload',\n    listInstances => {\n      console.log('cmsload Successfully loaded!');\n\n      const [listInstance] = listInstances;\n      \n      if (!listInstance) {\n        return;\n      }\n\n      /**\n       * to manually activate the nest for all-compoennts inspirations with nest-collectin using slugs\n       * beasue inspiration collection has more than 100 items\n       */\n      // if(window.fsAttributes.cmsnest){\n      //     window.fsAttributes.cmsnest.init();\n      // }\n\n      listInstance.on('renderitems', renderedItems => {\n        console.log('page changed');\n        scrollToTop();\n        setListener();\n      });\n    },\n  ]);\n\n  setListener();\n\n  $(document).on(\n    'click',\n    '[paddle-action-btn=\"freelance-monthly\"]',\n    openFreelanceMonthlyCheckout\n  );\n\n  $(document).on(\n    'click',\n    '[paddle-action-btn=\"freelance-yearly\"]',\n    openFreelanceYearlyCheckout\n  );\n\n  $(document).on('click', '[paddle-action-btn=\"update\"]', openUpdatePaddle);\n\n  $(document).on('click', '[paddle-action-btn=\"cancel\"]', openCancelPaddle);\n\n  /**\n   * --------------------------------------------------------------------------------------\n   * END CONTROLLERS\n   *\n   */\n})().catch(err => {\n  console.error(err);\n});\n"],"names":["window","fsAttributes","urlParams","URLSearchParams","location","search","baseUrlGTilebit","platformData","contentType","isSnippetCopy","xtoken","xUserId","member","memberJson","paddleSubscription","paddleFreelanceMonthlyId","paddleFreelanceYearlyId","accessToken","get","localStorage","getItem","setListener","setTippyHover","$","click","event","stopPropagation","state","isPaidSubscritionActive","href","platform","this","attr","id","closest","element","componentId","endpoint","platformwrapper","find","clone","async","displayMessage","message","setTimeout","text","empty","append","css","callXApi","then","responseData","charAt","document","execCommand","catch","error","copyComponent","ClipboardJS","on","el","tippyInstance","trigger","_tippy","setContent","show","tippy","duration","onShow","instance","hide","itemId","savedInspo","indexOf","push","num","length","savedInspoNum","update","SavedInspirations","JSON","stringify","savedComp","savedCompNum","SavedComponents","name","trim","metadata","fileNames","splice","itemsNum","updateMetaData","remove","baseUrlGroup","method","data","url","options","Authorization","body","response","fetch","json","Error","Outseta","getUser","user","amplitude","setUserId","Uid","memberJsonData","parse","err","res","token","authToken","user_id","console","paddleRes","listInstances","log","listInstance","renderedItems","getElementById","scrollIntoView","behavior","block","Paddle","Checkout","open","product","email","Email","passthrough","override","update_url","cancel_url"],"version":3,"file":"index.21426a65.js.map"}