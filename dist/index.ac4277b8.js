(async()=>{window.fsAttributes=window.fsAttributes||[];const t=new URLSearchParams(window.location.search);let e="https://xju6-kpzy-l8vj.n7.xano.io/api:4lTavcfO",n="https://xju6-kpzy-l8vj.n7.xano.io/api:8p4wLdYy",o="https://xju6-kpzy-l8vj.n7.xano.io/api:9U9Y_l4P",a="",s="",i=!1,c=null,d=null,l=null,r=null,u={},p=null;const m=52522,f=52668;let h=t.get("access_token")?t.get("access_token"):localStorage.getItem("Outseta.nocode.accessToken");const b=()=>{v()&&$(".lock").hide(),setTippyHover(),$(".actions-button-wrapper, [action-button]").click((function(t){return t.stopPropagation(),!0})),$("[bmg-arco-button]").click((function(t){if(!r)return void $("[lock-modal-button]")[0].click();if(!$(this).parent().siblings().find(".lock").hasClass("w-condition-invisible")&&!v())return void(window.location.href="/pricing");const n=$(this).attr("bmg-arco-button"),o=$(this).closest("[tb-item-id]").attr("tb-item-id");!function(t,n,o){const c=`components/${o}/platform/${n}`;let d=t.find("[tb-pl-butt-wrapper]").clone();async function l(e){setTimeout((function(){t.text(e),setTimeout((function(){t.empty(),t.append(d),t.css({"pointer-events":"auto"})}),1500)}),1500)}t.css({"pointer-events":"none"}),t.empty(),t.text("Copying..."),g(e,c,"GET").then((t=>{a=t[n],s="{"===a.charAt(0)?"application/json":"text/html",i=!0,document.execCommand("copy"),l("Copied!")})).catch((t=>{l(t)}))}($(this),n,o)})),new ClipboardJS("[data-clipboard-text]").on("success",(function(t){const e=t.trigger._tippy;e.setContent("Copied"),e.show()})),tippy("[data-tippy-content]",{trigger:"manual",duration:100,onShow(t){setTimeout((()=>{t.hide()}),1e3)}}),$("[comp-card-save-btn]").click((async function(t){if(!r)return void $("[lock-modal-button]")[0].click();const e=this._tippy,n=$(this).closest("[tb-item-id]").attr("tb-item-id");if("inspiration"===$(this).closest("[comp-card]").attr("comp-card")){if(u.savedInspo=u.savedInspo||[],-1===u.savedInspo.indexOf(n)){u.savedInspo.push(n);const t=u.savedInspo.length||0;return u.savedInspoNum=t,await r.update({SavedInspirations:JSON.stringify(u.savedInspo)}),e.setContent("Saved"),void e.show()}}else if(u.savedComp=u.savedComp||[],-1===u.savedComp.indexOf(n)){u.savedComp.push(n);const t=u.savedComp.length||0;return u.savedCompNum=t,await r.update({SavedComponents:JSON.stringify(u.savedComp)}),e.setContent("Saved"),void e.show()}e.setContent("Already saved"),e.show()})),$(document).on("click",".hack32-like-item .del",(function(){const t=$.trim($(this).closest(".hack32-like-item").find(".hack32-title").text());-1!==metadata.fileNames.indexOf(t)&&(metadata.fileNames.splice(metadata.fileNames.indexOf(t),1),metadata.itemsNum=metadata.fileNames.length,$(".hack32-like-count").text(metadata.itemsNum),r.updateMetaData(metadata)),$(this).closest(".hack32-like-item").remove()}))};async function g(t,e,n,o){const a=`${t}/${e}`,s={method:n,headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify(o)};try{const t=await fetch(a,s),e=await t.json();if(!t.ok)throw e.message;return e}catch(t){throw new Error(t)}}function v(){if(!p)return!1;const t=(new Date).getTime();return"active"==p.status||"trialing"==p.status||"past_due"==p.status||"deleted"==p.status&&t<p.end_date}function k(t,e,n){let a=t.find("div:first")[0];const s=a.textContent;t.css({"pointer-events":"none"}),a.textContent="Loading...",g(o,"user/change-plan","POST",{new_plan:e,subscription_id:n}).then((t=>{if(!t.success)throw new Error(t.error.message);window.location.href="freelance-yearly"!=e?"/downgraded-plan":"/updated-plan"})).catch((e=>{!async function(e){setTimeout((function(){a.textContent=e,setTimeout((function(){a.textContent=s,t.css({"pointer-events":"auto"})}),1500)}),1500)}(e)}))}function y(t){const e=new Date;e.setTime(t);const n=e.getDate(),o=e.getMonth(),a=e.getFullYear();return`${n} ${function(t){return["January","February","March","April","May","June","July","August","September","October","November","December"][t]}(o)} ${a}`}if(h){Outseta.getUser().then((t=>{r=t,amplitude.setUserId(r.Uid);const e={};e.savedComp=JSON.parse(r.SavedComponents||"[]"),e.savedInspo=JSON.parse(r.SavedInspirations||"[]"),u=e})).catch((t=>{})),await async function(){try{const t=await g(n,"outseta/auth","POST",{token:h});t?.authToken&&(c=t.authToken,d=t.user.id,l=t.user,Outseta.setAccessToken(t.os_access_token),h=t.os_access_token,p=t.user.paddle)}catch(t){console.error("erore nel recupero xano token")}}();const t=$('[tb-el="profile-section"]'),e=$('[tb-el="pricing-component"]');t.length>0&&function(){paddleInfo=p,$('[tb-el="member-pricing"]')[0];const t=$('[tb-el="sub-trial-text"]'),e=$('[tb-el="sub-status"]')[0],n=$('[tb-el="profile-section"]')[0],o=$('[tb-el="deleted-info-block"]')[0],a=$('[tb-el="next-payment-block"]')[0],s=$('[tb-el="sub-renew-date"]')[0],i=$('[tb-el="sub-end-date"]')[0],c=$('[paddle-action-btn="update"]')[0];$(e).text(paddleInfo.status),$(s).text(y(paddleInfo.renewal_date)),paddleInfo.refunded?$(i).text("Refunded"):$(i).text(y(paddleInfo.end_date)),paddleInfo.status?(v()&&"deleted"!==paddleInfo.status&&$(o).hide(),"deleted"==paddleInfo.status&&($(a).hide(),$(c).hide()),"trialing"!==paddleInfo.status&&$(t).hide()):$(n).hide()}(),e.length>0&&function(){paddleInfo=p;const t=$('[tb-el="downgrade-monthly-btn"]')[0],e=$('[tb-el="upgrade-yearly-btn"]')[0];if("active"!=paddleInfo.status)return $('[tb-el="downgrade-modal-btn"]').hide(),void $('[tb-el="upgrade-modal-btn"]').hide();$(e).click((()=>k($(e),"freelance-yearly",paddleInfo.subscription_id))),$(t).click((()=>k($(t),"freelance-monthly",paddleInfo.subscription_id)))}()}window.fsAttributes.push(["cmsload",t=>{console.log("cmsload Successfully loaded!");const[e]=t;e&&e.on("renderitems",(t=>{console.log("page changed"),b()}))}]),b(),document.addEventListener("copy",(t=>{i&&(t.clipboardData.setData(s,a),t.preventDefault(),i=!1)})),$(document).on("click",'[paddle-action-btn="freelance-monthly"]',(function(){Paddle.Checkout.open({product:m,email:r.Email,passthrough:`{"x_user_id": "${d}"}`,success:"/success"})})),$(document).on("click",'[paddle-action-btn="freelance-yearly"]',(function(){Paddle.Checkout.open({product:f,email:r.Email,passthrough:`{"x_user_id": "${d}"}`,success:"/success"})})),$(document).on("click",'[paddle-action-btn="update"]',(function(){Paddle.Checkout.open({override:p.update_url,passthrough:`{"x_user_id": "${d}"}`,success:"/subscription-updated"})})),$(document).on("click",'[paddle-action-btn="cancel"]',(function(){Paddle.Checkout.open({override:p.cancel_url,passthrough:`{"x_user_id": "${d}"}`,success:"/subscription-deleted"})}))})().catch((t=>{console.error(t)}));
//# sourceMappingURL=index.ac4277b8.js.map
